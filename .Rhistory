ggplot( ., aes(x = Fv, y = value, color = variable, linetype = variable)) +
geom_line(lwd = 1.1) +
labs(x =  as.expression(bquote(F[Total])),
y = ifelse(i == 1, 'Yield',""),
color = "", linetype = "") +
scale_color_manual(values = c('grey22','grey66','grey22','grey66')) +
scale_linetype_manual(values = c('solid','solid','dotted','dotted')) +
scale_y_continuous(limits = c(0,50))+
# scale_y_continuous(limits = c(0,max(propI[,2:(narea+1)])*1.1)) +
theme_sleek() +
# theme(legend.position = 'none')
theme(legend.position = if(i < length(R0_list)) 'none' else c(0.75,0.8)) #+ ggtitle("high oscillation problem -- conclude on 99th iteration")
# annotate('text', x = 0.75, y = 60,
#          color ='grey66',
#          label = as.expression(bquote(F[MSY]~"="~.(A1[i])))) +
# annotate('text', x = 0.75, y = 55,
#          color ='grey44',
#          label = as.expression(bquote(F[MSY]~"="~.(A2[i])))) +
# annotate('text', x = 0.75, y = 50,
#          color ='grey22',
#          label = as.expression(bquote(F[MSY]~"="~.(A3[i])))) +
# annotate('text', x = 0.75, y = 45,
#          color ='blue',
#          label = as.expression(bquote(Total~Yield~"="~.(sum(areaopt[i,5:7]))))) +
#
# blist[[i]] <-  ggplot( ) +
#   geom_line(data = propi1, lwd = 1.1,
#             aes(x = Fv, y = B, col = 'Area 1') ) +
#   geom_line(data = propi2, lwd = 1.1,
#             aes(x = Fv, y = B, col = 'Area 2') ) +
#   geom_line(data = propi3, lwd = 1.1,
#             aes(x = Fv, y = B, col = 'Area 3') ) +
#   labs(x = 'F', y = ifelse(i == 1, 'B',""), color = "") +
#   scale_color_grey() +
#   scale_y_continuous(limits = c(0,625)) +
#   theme_sleek() +
#   theme(legend.position = 'none') #+ ggtitle("high oscillation problem -- conclude on 99th iteration")
}
plist2 <- list()
for(RR in 1:length(R0_list)){
plist2[[RR]] <- ggdraw() +
draw_plot(p1list[[RR]] +
annotate('text', x = 0, y = 35,
label = toupper(letters[(splitid-1)*3+RR]), cex = 6)) +
draw_plot(barlist[[RR]]+
annotate('text', x = (narea+1)/2,
y = 750,
cex = 2,
label = 'Initial Recruitment'),
x = 0.65, y = 0.2,
width = .25, height = .25)
}
return(plist2)
}
}
for(s in 1:3){
splt <- list(c(1,1),
c(0.7,0.3),
c(0.2,0.8))[[s]]
## custom Ftest to max at 1
Ftest <- seq(0,1/min(splt),0.05) ## 80% of 1.25 is 1.0, so examining full expl
## loop system wide F
fyr_2area <- array(NA, dim = c(length(Ftest),4, length(R0_list))) ## F x 3  x RR
far_2area <- array(NA, dim = c(length(Ftest),2*narea+1, length(R0_list))) ## F x 3 x narea x RR
kvar_radj_2area <- kvar_radj_2areaAB <-  array(NA, dim = c(maxiter,length(Ftest),narea+1,length(R0_list))) ## iters, Fv, 2 areas , RR x movements
for(RR in 1:length(R0_list)){
for(Fv in 1:length(Ftest)){
curr <- run_one_current(Fv_i = Ftest[Fv]*splt,
rec_level_idx = RR,
movemat = X_ija_MIX2)
# cat(curr$Yield,"\n")
current_Req <- curr$R_ESUMB
prop <- optim_loop2(Fv_i = Ftest[Fv]*splt, #rep(Ftest[Fv],narea),#
rec_level_idx = RR,
movemat = X_ija_MIX2)
abprop <- abloop(Fv_i = Ftest[Fv]*splt,
rec_level_idx = RR,
movemat = X_ija_MIX2)
fyr_2area[Fv,1,RR] <- Ftest[Fv]
fyr_2area[Fv,2,RR] <- curr$Yield
fyr_2area[Fv,3,RR] <- prop$Yield
fyr_2area[Fv,4,RR] <- abprop$Yield
far_2area[Fv,1,RR] <- Ftest[Fv]
far_2area[Fv,2,RR] <- prop$Yield_i[1]
far_2area[Fv,3,RR] <- prop$Yield_i[2]
far_2area[Fv,4,RR] <- abprop$Yield_i[1]
far_2area[Fv,5,RR] <- abprop$Yield_i[2]
kvar_radj_2area[,Fv,2:3,RR] <- prop$radj
kvar_radj_2area[,Fv,1,RR] <-    kvar_radj_2areaAB[,Fv,1,RR]  <- Ftest[Fv]
kvar_radj_2areaAB[,Fv,2:3,RR] <- abprop$radj
} ## end Fs
} ## end input rec levels
## plot radj
# png(here('figs',paste0('R_eq_ABsyntax_2area_Buff=0.005_5ppenalty_MIX2b_',
#                        paste(splt,collapse = "_"),"_",
#                        Sys.Date(),'.png')),
#     height = 8.5, width = 11, unit = 'in', res = 600)
# plot_radj(radj_kvar = kvar_radj_2areaAB, Fidx = 12:16)
# dev.off()
#
#
# png(here('figs',paste0('R_eq_SSsyntax_2area_Buff=0.005_5ppenalty_MIX2b_',
#                        paste(splt,collapse = "_"),"_",
#                        Sys.Date(),'.png')),
#     height = 8.5, width = 11, unit = 'in', res = 600)
# plot_radj(radj_kvar = kvar_radj_2area, Fidx = 12:16)
# dev.off()
# ## plot yield comps solo and by area
# cat(idx,"\n")
for(i in 1:length(R0_list)){
master_plots[[idx]] <- plot_yield_curves(sys_matrix = fyr_2area,
byarea = FALSE,
splitid = s)[[i]]
master_plots_area[[idx]] <- plot_yield_curves(sys_matrix  = far_2area,
splitid = s,
byarea = TRUE)[[i]]
idx = idx+1
}
}
master_plots <- master_plots_area <- list();idx = 1
for(s in 1:3){
splt <- list(c(1,1),
c(0.7,0.3),
c(0.2,0.8))[[s]]
## custom Ftest to max at 1
Ftest <- seq(0,1/min(splt),0.05) ## 80% of 1.25 is 1.0, so examining full expl
## loop system wide F
fyr_2area <- array(NA, dim = c(length(Ftest),4, length(R0_list))) ## F x 3  x RR
far_2area <- array(NA, dim = c(length(Ftest),2*narea+1, length(R0_list))) ## F x 3 x narea x RR
kvar_radj_2area <- kvar_radj_2areaAB <-  array(NA, dim = c(maxiter,length(Ftest),narea+1,length(R0_list))) ## iters, Fv, 2 areas , RR x movements
for(RR in 1:length(R0_list)){
for(Fv in 1:length(Ftest)){
curr <- run_one_current(Fv_i = Ftest[Fv]*splt,
rec_level_idx = RR,
movemat = X_ija_MIX2)
# cat(curr$Yield,"\n")
current_Req <- curr$R_ESUMB
prop <- optim_loop2(Fv_i = Ftest[Fv]*splt, #rep(Ftest[Fv],narea),#
rec_level_idx = RR,
movemat = X_ija_MIX2)
abprop <- abloop(Fv_i = Ftest[Fv]*splt,
rec_level_idx = RR,
movemat = X_ija_MIX2)
fyr_2area[Fv,1,RR] <- Ftest[Fv]
fyr_2area[Fv,2,RR] <- curr$Yield
fyr_2area[Fv,3,RR] <- prop$Yield
fyr_2area[Fv,4,RR] <- abprop$Yield
far_2area[Fv,1,RR] <- Ftest[Fv]
far_2area[Fv,2,RR] <- prop$Yield_i[1]
far_2area[Fv,3,RR] <- prop$Yield_i[2]
far_2area[Fv,4,RR] <- abprop$Yield_i[1]
far_2area[Fv,5,RR] <- abprop$Yield_i[2]
kvar_radj_2area[,Fv,2:3,RR] <- prop$radj
kvar_radj_2area[,Fv,1,RR] <-    kvar_radj_2areaAB[,Fv,1,RR]  <- Ftest[Fv]
kvar_radj_2areaAB[,Fv,2:3,RR] <- abprop$radj
} ## end Fs
} ## end input rec levels
## plot radj
# png(here('figs',paste0('R_eq_ABsyntax_2area_Buff=0.005_5ppenalty_MIX2b_',
#                        paste(splt,collapse = "_"),"_",
#                        Sys.Date(),'.png')),
#     height = 8.5, width = 11, unit = 'in', res = 600)
# plot_radj(radj_kvar = kvar_radj_2areaAB, Fidx = 12:16)
# dev.off()
#
#
# png(here('figs',paste0('R_eq_SSsyntax_2area_Buff=0.005_5ppenalty_MIX2b_',
#                        paste(splt,collapse = "_"),"_",
#                        Sys.Date(),'.png')),
#     height = 8.5, width = 11, unit = 'in', res = 600)
# plot_radj(radj_kvar = kvar_radj_2area, Fidx = 12:16)
# dev.off()
# ## plot yield comps solo and by area
# cat(idx,"\n")
for(i in 1:length(R0_list)){
master_plots[[idx]] <- plot_yield_curves(sys_matrix = fyr_2area,
byarea = FALSE,
splitid = s)[[i]]
master_plots_area[[idx]] <- plot_yield_curves(sys_matrix  = far_2area,
splitid = s,
byarea = TRUE)[[i]]
idx = idx+1
}
}
Rmisc::multiplot(plotlist = master_plots_area,
layout = matrix(1:9, nrow = 3, ncol = 3, byrow = TRUE))
ggsave( Rmisc::multiplot(plotlist = master_plots,
layout = matrix(1:9, nrow = 3, ncol = 3, byrow = TRUE)),
file = here::here('figs', paste0("Yields_total_MIX2_",Sys.Date(),'.png')),
width = 10, height = 8, unit = 'in', dpi = 520)
ggsave( Rmisc::multiplot(plotlist = master_plots_area,
layout = matrix(1:9, nrow = 3, ncol = 3, byrow = TRUE)),
file = here::here('figs',paste0("Yields_area_MIX2_",  Sys.Date(),'.png')),
width = 10, height = 8, unit = 'in', dpi = 520)
rm(list = ls())
# for running example
require(reshape)
require(dplyr, quietly = T)
require(here)
require(stats4)
## for plotting
require(cowplot)
require(patchwork)
require(ggsidekick)
require(ggplot2, quietly = T)
## settings ----
narea <- 2
nages <- 21
steep <- rep(0.7,2)
R0_list <- list(c(500,500)*0.5, c(300,700)*0.5, c(700,300)*0.5)
lapply(list.files(here::here("R"), full.names = TRUE), source)
maxiter =  21
## Find Ftotal MSY for plotting ----
sysopt <- sysoptAB <- array(NA, dim = c(3,8,3)) ## RR X cols x S
sysopt_curr <- array(NA, dim = c(3,4,3))
s = 1
master_plots <- master_plots_area <- list();idx = 1
splt <- list(c(1,1),
c(0.7,0.3),
c(0.2,0.8))[[s]]
## custom Ftest to max at 1
Ftest <- seq(0,1/min(splt),0.05) ## 80% of 1.25 is 1.0, so examining full expl
## loop system wide F
fyr_2area <- array(NA, dim = c(length(Ftest),4, length(R0_list))) ## F x 3  x RR
far_2area <- array(NA, dim = c(length(Ftest),2*narea+1, length(R0_list))) ## F x 3 x narea x RR
kvar_radj_2area <- kvar_radj_2areaAB <-  array(NA, dim = c(maxiter,length(Ftest),narea+1,length(R0_list))) ## iters, Fv, 2 areas , RR x movements
RR = 1
for(Fv in 1:length(Ftest)){
curr <- run_one_current(Fv_i = Ftest[Fv]*splt,
rec_level_idx = RR,
movemat = X_ija_MIX2)
# cat(curr$Yield,"\n")
current_Req <- curr$R_ESUMB
prop <- optim_loop2(Fv_i = Ftest[Fv]*splt, #rep(Ftest[Fv],narea),#
rec_level_idx = RR,
movemat = X_ija_MIX2)
abprop <- abloop(Fv_i = Ftest[Fv]*splt,
rec_level_idx = RR,
movemat = X_ija_MIX2)
fyr_2area[Fv,1,RR] <- Ftest[Fv]
fyr_2area[Fv,2,RR] <- curr$Yield
fyr_2area[Fv,3,RR] <- prop$Yield
fyr_2area[Fv,4,RR] <- abprop$Yield
far_2area[Fv,1,RR] <- Ftest[Fv]
far_2area[Fv,2,RR] <- prop$Yield_i[1]
far_2area[Fv,3,RR] <- prop$Yield_i[2]
far_2area[Fv,4,RR] <- abprop$Yield_i[1]
far_2area[Fv,5,RR] <- abprop$Yield_i[2]
kvar_radj_2area[,Fv,2:3,RR] <- prop$radj
kvar_radj_2area[,Fv,1,RR] <-    kvar_radj_2areaAB[,Fv,1,RR]  <- Ftest[Fv]
kvar_radj_2areaAB[,Fv,2:3,RR] <- abprop$radj
} ## end Fs
## plot radj
# png(here('figs',paste0('R_eq_ABsyntax_2area_Buff=0.005_5ppenalty_MIX2b_',
#                        paste(splt,collapse = "_"),"_",
#                        Sys.Date(),'.png')),
#     height = 8.5, width = 11, unit = 'in', res = 600)
plot_radj(radj_kvar = kvar_radj_2areaAB, Fidx = 12:16)
abprop$radj
kvar_radj_2areaAB
## plot radj
# png(here('figs',paste0('R_eq_ABsyntax_2area_Buff=0.005_5ppenalty_MIX2b_',
#                        paste(splt,collapse = "_"),"_",
#                        Sys.Date(),'.png')),
#     height = 8.5, width = 11, unit = 'in', res = 600)
plot_radj(radj_kvar = kvar_radj_2areaAB, Fidx = 12:16)
plotseq = 12:15
## plot radj
# png(here('figs',paste0('R_eq_ABsyntax_2area_Buff=0.005_5ppenalty_MIX2b_',
#                        paste(splt,collapse = "_"),"_",
#                        Sys.Date(),'.png')),
#     height = 8.5, width = 11, unit = 'in', res = 600)
plot_radj(radj_kvar = kvar_radj_2area, Fidx = 12:16)
radj_kvar = kvar_radj_2area
par(mfrow = c(dim(radj_kvar)[4],
length(plotseq)),
mar = c(5,5,1.5,1.5))
for(i in 1:dim(radj_kvar)[4]){
radj <- radj_kvar[,,,i]
for(j in plotseq){
if(i == dim(radj_kvar)[4] & j == max(plotseq)) next()
tmpx=NULL
for(a in 1:narea) tmpx[a] = min(which(is.na(radj[,j,a+1])))
tmpx[tmpx == Inf] <- 101
plot(radj[,j,2], col = 'black',
type = 'l',
ylim = c(0,1500),
xlab = 'Iteration No.',
xlim = c(0,  max(tmpx)),
ylab =  'R_eq')
text(x = max(tmpx)*0.5, y = 1250,
cex = 1.5, label = paste0('F = ',Ftest[j]))
## niter x fv x areas
for(k in 3:(narea+1)){
lines(radj[,j,k], col = c('blue','red')[k-2])
}
} ## end j (Fs)
}
## plot radj
# png(here('figs',paste0('R_eq_ABsyntax_2area_Buff=0.005_5ppenalty_MIX2b_',
#                        paste(splt,collapse = "_"),"_",
#                        Sys.Date(),'.png')),
#     height = 8.5, width = 11, unit = 'in', res = 600)
plot_radj(radj_kvar = kvar_radj_2area, Fidx = 17:20)
## loop system wide F
fyr_2area <- array(NA, dim = c(length(Ftest),4, length(R0_list))) ## F x 3  x RR
far_2area <- array(NA, dim = c(length(Ftest),2*narea+1, length(R0_list))) ## F x 3 x narea x RR
kvar_radj_2area <- kvar_radj_2areaAB <-  array(NA, dim = c(maxiter,length(Ftest),narea+1,length(R0_list))) ## iters, Fv, 2 areas , RR x movements
for(RR in 1:length(R0_list)){
for(Fv in 1:length(Ftest)){
curr <- run_one_current(Fv_i = Ftest[Fv]*splt,
rec_level_idx = RR,
movemat = X_ija_MIX2)
# cat(curr$Yield,"\n")
current_Req <- curr$R_ESUMB
prop <- optim_loop2(Fv_i = Ftest[Fv]*splt, #rep(Ftest[Fv],narea),#
rec_level_idx = RR,
movemat = X_ija_MIX2)
abprop <- abloop(Fv_i = Ftest[Fv]*splt,
rec_level_idx = RR,
movemat = X_ija_MIX2)
fyr_2area[Fv,1,RR] <- Ftest[Fv]
fyr_2area[Fv,2,RR] <- curr$Yield
fyr_2area[Fv,3,RR] <- prop$Yield
fyr_2area[Fv,4,RR] <- abprop$Yield
far_2area[Fv,1,RR] <- Ftest[Fv]
far_2area[Fv,2,RR] <- prop$Yield_i[1]
far_2area[Fv,3,RR] <- prop$Yield_i[2]
far_2area[Fv,4,RR] <- abprop$Yield_i[1]
far_2area[Fv,5,RR] <- abprop$Yield_i[2]
kvar_radj_2area[,Fv,2:3,RR] <- prop$radj
kvar_radj_2area[,Fv,1,RR] <-    kvar_radj_2areaAB[,Fv,1,RR]  <- Ftest[Fv]
kvar_radj_2areaAB[,Fv,2:3,RR] <- abprop$radj
} ## end Fs
} ## end input rec levels
## plot radj
# png(here('figs',paste0('R_eq_ABsyntax_2area_Buff=0.005_5ppenalty_MIX2b_',
#                        paste(splt,collapse = "_"),"_",
#                        Sys.Date(),'.png')),
#     height = 8.5, width = 11, unit = 'in', res = 600)
plot_radj(radj_kvar = kvar_radj_2area, Fidx = 17:20)
## plot radj
# png(here('figs',paste0('R_eq_ABsyntax_2area_Buff=0.005_5ppenalty_MIX2b_',
#                        paste(splt,collapse = "_"),"_",
#                        Sys.Date(),'.png')),
#     height = 8.5, width = 11, unit = 'in', res = 600)
plot_radj(radj_kvar = kvar_radj_2area, Fidx = 21:25)
s = 2
splt <- list(c(1,1),
c(0.7,0.3),
c(0.2,0.8))[[s]]
## loop system wide F
fyr_2area <- array(NA, dim = c(length(Ftest),4, length(R0_list))) ## F x 3  x RR
## custom Ftest to max at 1
Ftest <- seq(0,1/min(splt),0.05) ## 80% of 1.25 is 1.0, so examining full expl
far_2area <- array(NA, dim = c(length(Ftest),2*narea+1, length(R0_list))) ## F x 3 x narea x RR
kvar_radj_2area <- kvar_radj_2areaAB <-  array(NA, dim = c(maxiter,length(Ftest),narea+1,length(R0_list))) ## iters, Fv, 2 areas , RR x movements
for(RR in 1:length(R0_list)){
for(Fv in 1:length(Ftest)){
curr <- run_one_current(Fv_i = Ftest[Fv]*splt,
rec_level_idx = RR,
movemat = X_ija_MIX2)
# cat(curr$Yield,"\n")
current_Req <- curr$R_ESUMB
prop <- optim_loop2(Fv_i = Ftest[Fv]*splt, #rep(Ftest[Fv],narea),#
rec_level_idx = RR,
movemat = X_ija_MIX2)
abprop <- abloop(Fv_i = Ftest[Fv]*splt,
rec_level_idx = RR,
movemat = X_ija_MIX2)
fyr_2area[Fv,1,RR] <- Ftest[Fv]
fyr_2area[Fv,2,RR] <- curr$Yield
fyr_2area[Fv,3,RR] <- prop$Yield
fyr_2area[Fv,4,RR] <- abprop$Yield
far_2area[Fv,1,RR] <- Ftest[Fv]
far_2area[Fv,2,RR] <- prop$Yield_i[1]
far_2area[Fv,3,RR] <- prop$Yield_i[2]
far_2area[Fv,4,RR] <- abprop$Yield_i[1]
far_2area[Fv,5,RR] <- abprop$Yield_i[2]
kvar_radj_2area[,Fv,2:3,RR] <- prop$radj
kvar_radj_2area[,Fv,1,RR] <-    kvar_radj_2areaAB[,Fv,1,RR]  <- Ftest[Fv]
kvar_radj_2areaAB[,Fv,2:3,RR] <- abprop$radj
} ## end Fs
} ## end input rec levels
for(RR in 1:length(R0_list)){
for(Fv in 1:length(Ftest)){
curr <- run_one_current(Fv_i = Ftest[Fv]*splt,
rec_level_idx = RR,
movemat = X_ija_MIX2)
# cat(curr$Yield,"\n")
current_Req <- curr$R_ESUMB
prop <- optim_loop2(Fv_i = Ftest[Fv]*splt, #rep(Ftest[Fv],narea),#
rec_level_idx = RR,
movemat = X_ija_MIX2)
abprop <- abloop(Fv_i = Ftest[Fv]*splt,
rec_level_idx = RR,
movemat = X_ija_MIX2)
fyr_2area[Fv,1,RR] <- Ftest[Fv]
fyr_2area[Fv,2,RR] <- curr$Yield
fyr_2area[Fv,3,RR] <- prop$Yield
fyr_2area[Fv,4,RR] <- abprop$Yield
far_2area[Fv,1,RR] <- Ftest[Fv]
far_2area[Fv,2,RR] <- prop$Yield_i[1]
far_2area[Fv,3,RR] <- prop$Yield_i[2]
far_2area[Fv,4,RR] <- abprop$Yield_i[1]
far_2area[Fv,5,RR] <- abprop$Yield_i[2]
kvar_radj_2area[,Fv,2:3,RR] <- prop$radj
kvar_radj_2area[,Fv,1,RR] <-    kvar_radj_2areaAB[,Fv,1,RR]  <- Ftest[Fv]
kvar_radj_2areaAB[,Fv,2:3,RR] <- abprop$radj
} ## end Fs
} ## end input rec levels
splt
## custom Ftest to max at 1
Ftest <- seq(0,1/min(splt),0.05) ## 80% of 1.25 is 1.0, so examining full expl
## loop system wide F
fyr_2area <- array(NA, dim = c(length(Ftest),4, length(R0_list))) ## F x 3  x RR
far_2area <- array(NA, dim = c(length(Ftest),2*narea+1, length(R0_list))) ## F x 3 x narea x RR
kvar_radj_2area <- kvar_radj_2areaAB <-  array(NA, dim = c(maxiter,length(Ftest),narea+1,length(R0_list))) ## iters, Fv, 2 areas , RR x movements
for(RR in 1:length(R0_list)){
for(Fv in 1:length(Ftest)){
curr <- run_one_current(Fv_i = Ftest[Fv]*splt,
rec_level_idx = RR,
movemat = X_ija_MIX2)
# cat(curr$Yield,"\n")
current_Req <- curr$R_ESUMB
prop <- optim_loop2(Fv_i = Ftest[Fv]*splt, #rep(Ftest[Fv],narea),#
rec_level_idx = RR,
movemat = X_ija_MIX2)
abprop <- abloop(Fv_i = Ftest[Fv]*splt,
rec_level_idx = RR,
movemat = X_ija_MIX2)
fyr_2area[Fv,1,RR] <- Ftest[Fv]
fyr_2area[Fv,2,RR] <- curr$Yield
fyr_2area[Fv,3,RR] <- prop$Yield
fyr_2area[Fv,4,RR] <- abprop$Yield
far_2area[Fv,1,RR] <- Ftest[Fv]
far_2area[Fv,2,RR] <- prop$Yield_i[1]
far_2area[Fv,3,RR] <- prop$Yield_i[2]
far_2area[Fv,4,RR] <- abprop$Yield_i[1]
far_2area[Fv,5,RR] <- abprop$Yield_i[2]
kvar_radj_2area[,Fv,2:3,RR] <- prop$radj
kvar_radj_2area[,Fv,1,RR] <-    kvar_radj_2areaAB[,Fv,1,RR]  <- Ftest[Fv]
kvar_radj_2areaAB[,Fv,2:3,RR] <- abprop$radj
} ## end Fs
} ## end input rec levels
## plot radj
# png(here('figs',paste0('R_eq_ABsyntax_2area_Buff=0.005_5ppenalty_MIX2b_',
#                        paste(splt,collapse = "_"),"_",
#                        Sys.Date(),'.png')),
#     height = 8.5, width = 11, unit = 'in', res = 600)
plot_radj(radj_kvar = kvar_radj_2area, Fidx = 21:25)
## plot radj
# png(here('figs',paste0('R_eq_ABsyntax_2area_Buff=0.005_5ppenalty_MIX2b_',
#                        paste(splt,collapse = "_"),"_",
#                        Sys.Date(),'.png')),
#     height = 8.5, width = 11, unit = 'in', res = 600)
plot_radj(radj_kvar = kvar_radj_2area, Fidx = 15:20)
s = 3
## plot radj
# png(here('figs',paste0('R_eq_ABsyntax_2area_Buff=0.005_5ppenalty_MIX2b_',
#                        paste(splt,collapse = "_"),"_",
#                        Sys.Date(),'.png')),
#     height = 8.5, width = 11, unit = 'in', res = 600)
plot_radj(radj_kvar = kvar_radj_2area, Fidx = 10:15)
splt <- list(c(1,1),
c(0.7,0.3),
c(0.2,0.8))[[s]]
## custom Ftest to max at 1
Ftest <- seq(0,1/min(splt),0.05) ## 80% of 1.25 is 1.0, so examining full expl
## loop system wide F
fyr_2area <- array(NA, dim = c(length(Ftest),4, length(R0_list))) ## F x 3  x RR
far_2area <- array(NA, dim = c(length(Ftest),2*narea+1, length(R0_list))) ## F x 3 x narea x RR
kvar_radj_2area <- kvar_radj_2areaAB <-  array(NA, dim = c(maxiter,length(Ftest),narea+1,length(R0_list))) ## iters, Fv, 2 areas , RR x movements
for(RR in 1:length(R0_list)){
for(Fv in 1:length(Ftest)){
curr <- run_one_current(Fv_i = Ftest[Fv]*splt,
rec_level_idx = RR,
movemat = X_ija_MIX2)
# cat(curr$Yield,"\n")
current_Req <- curr$R_ESUMB
prop <- optim_loop2(Fv_i = Ftest[Fv]*splt, #rep(Ftest[Fv],narea),#
rec_level_idx = RR,
movemat = X_ija_MIX2)
abprop <- abloop(Fv_i = Ftest[Fv]*splt,
rec_level_idx = RR,
movemat = X_ija_MIX2)
fyr_2area[Fv,1,RR] <- Ftest[Fv]
fyr_2area[Fv,2,RR] <- curr$Yield
fyr_2area[Fv,3,RR] <- prop$Yield
fyr_2area[Fv,4,RR] <- abprop$Yield
far_2area[Fv,1,RR] <- Ftest[Fv]
far_2area[Fv,2,RR] <- prop$Yield_i[1]
far_2area[Fv,3,RR] <- prop$Yield_i[2]
far_2area[Fv,4,RR] <- abprop$Yield_i[1]
far_2area[Fv,5,RR] <- abprop$Yield_i[2]
kvar_radj_2area[,Fv,2:3,RR] <- prop$radj
kvar_radj_2area[,Fv,1,RR] <-    kvar_radj_2areaAB[,Fv,1,RR]  <- Ftest[Fv]
kvar_radj_2areaAB[,Fv,2:3,RR] <- abprop$radj
} ## end Fs
} ## end input rec levels
## plot radj
# png(here('figs',paste0('R_eq_ABsyntax_2area_Buff=0.005_5ppenalty_MIX2b_',
#                        paste(splt,collapse = "_"),"_",
#                        Sys.Date(),'.png')),
#     height = 8.5, width = 11, unit = 'in', res = 600)
plot_radj(radj_kvar = kvar_radj_2area, Fidx = 10:15)
## plot radj
# png(here('figs',paste0('R_eq_ABsyntax_2area_Buff=0.005_5ppenalty_MIX2b_',
#                        paste(splt,collapse = "_"),"_",
#                        Sys.Date(),'.png')),
#     height = 8.5, width = 11, unit = 'in', res = 600)
plot_radj(radj_kvar = kvar_radj_2area, Fidx = 20:25)
