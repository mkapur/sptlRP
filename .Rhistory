F_total = FF_Area1+FF_Area2 ) %>%
select(F_total, SB_Total) %>%
reshape2::melt(id = c("F_total")) %>%
mutate(Area = substr(variable,4,5), SB= value) %>%
select(-variable,-value)
out %>%
mutate(SB_Total = SB_A1+SB_A2,
F_total = FF_Area1+FF_Area2 ) %>%
select(F_total, SB_Total) %>%
reshape2::melt(id = c("F_total"))
out %>%
mutate(SB_Total = SB_A1+SB_A2,
F_total = FF_Area1+FF_Area2 ) %>%
select(F_total, SB_Total) %>%
reshape2::melt(id = c("F_total")) %>%
# mutate(Area = substr(variable,4,5), SB= value) %>%
select(-variable,-value) %>%
ggplot(., aes(x = F_total, y = SB_Total, fill = SB))
out %>%
mutate(SB_Total = SB_A1+SB_A2,
F_total = FF_Area1+FF_Area2 ) %>%
select(F_total, SB_Total) %>%
reshape2::melt(id = c("F_total"))
##  Composite F vs Composite SSB and Yield plots ----
FSB <- out %>%
mutate(SB_Total = SB_A1+SB_A2,
F_total = FF_Area1+FF_Area2 ) %>%
select(F_total, SB_Total) %>%
reshape2::melt(id = c("F_total")) %>% head()
FSB
out %>%
mutate(SB_Total = SB_A1+SB_A2,
F_total = FF_Area1+FF_Area2 ) %>%
select(F_total, SB_Total) %>%
reshape2::melt(id = c("F_total")) %>%
# mutate(Area = substr(variable,4,5), SB= value) %>%
select(-variable,-value) %>%
ggplot(., aes(x = F_total, y = value, fill = SB)) +
geom_tile() +
coord_equal() +
ggsidekick::theme_sleek() +
scale_x_continuous(expand = c(0,0)) +
scale_y_continuous(expand = c(0,0)) +
scale_fill_viridis_c() +
labs(x = 'Total F (summed)',
y = 'Total SB')
out %>%
mutate(SB_Total = SB_A1+SB_A2,
F_total = FF_Area1+FF_Area2 ) %>%
select(F_total, SB_Total) %>%
reshape2::melt(id = c("F_total")) %>%
# mutate(Area = substr(variable,4,5), SB= value) %>%
# select(-variable,-value) %>%
ggplot(., aes(x = F_total, y = value, fill = SB)) +
geom_line()
# geom_tile() +
# coord_equal() +
ggsidekick::theme_sleek() +
scale_x_continuous(expand = c(0,0)) +
scale_y_continuous(expand = c(0,0)) +
# scale_fill_viridis_c() +
labs(x = 'Total F (summed)',
y = 'Total SB')
out %>%
mutate(SB_Total = SB_A1+SB_A2,
F_total = FF_Area1+FF_Area2 ) %>%
select(F_total, SB_Total) %>%
reshape2::melt(id = c("F_total")) %>%
# mutate(Area = substr(variable,4,5), SB= value) %>%
# select(-variable,-value) %>%
ggplot(., aes(x = F_total, y = value, fill = SB)) +
geom_line() +
# geom_tile() +
# coord_equal() +
ggsidekick::theme_sleek() +
scale_x_continuous(expand = c(0,0)) +
scale_y_continuous(expand = c(0,0)) +
# scale_fill_viridis_c() +
labs(x = 'Total F (summed)',
y = 'Total SB')
##  Composite F vs Composite SSB and Yield plots ----
FSB <- out %>%
mutate(SB_Total = SB_A1+SB_A2,
F_total = FF_Area1+FF_Area2 ) %>%
select(F_total, SB_Total) %>%
reshape2::melt(id = c("F_total")) %>% head()
out %>%
mutate(SB_Total = SB_A1+SB_A2,
F_total = FF_Area1+FF_Area2 ) %>%
select(F_total, SB_Total) %>%
reshape2::melt(id = c("F_total")) %>%
# mutate(Area = substr(variable,4,5), SB= value) %>%
# select(-variable,-value) %>%
ggplot(., aes(x = F_total, y = value)) +
geom_line() +
# geom_tile() +
# coord_equal() +
ggsidekick::theme_sleek() +
scale_x_continuous(expand = c(0,0)) +
scale_y_continuous(expand = c(0,0)) +
# scale_fill_viridis_c() +
labs(x = 'Total F (summed)',
y = 'Total SB')
out %>%
filter(FF_Area2== 0.05) %>%
# mutate(Yield_Total = Yield_A1+Yield_A2) %>%
select(FF_Area1, Yield_A1) %>%
ggplot(., aes(x = FF_Area1, y = Yield_A1)) +
geom_line(lwd = 1.1) +
ggsidekick::theme_sleek() +
scale_x_continuous(expand = c(0,0)) + scale_y_continuous(expand = c(0,0)) +
scale_fill_viridis_c(option = 'magma') +
labs(x = 'F in Area 1',
y = 'Yield in Area 1')
out %>%
filter(FF_Area2== 0.05) %>%
select(FF_Area1, Yield_A1) %>%
cbind(.,out %>%
filter(FF_Area1== 0.05) %>%
select(FF_Area2, Yield_A2)  ) %>%
melt(id = c('Yield_A2',"Yield_A2")) %>% head()
out %>%
filter(FF_Area2== 0.05) %>%
select(FF_Area1, Yield_A1) %>%
cbind(.,out %>%
filter(FF_Area1== 0.05) %>%
select(FF_Area2, Yield_A2)  ) %>%
melt(id = c('Yield_A2',"Yield_A1")) %>% head()
melt(id = c('Yield_A2',"Yield_A1")) %>%  mutate(Area = substr(variable,4,8) %>% head()
out %>%
filter(FF_Area2== 0.05) %>%
select(FF_Area1, Yield_A1) %>%
cbind(.,out %>%
filter(FF_Area1== 0.05) %>%
select(FF_Area2, Yield_A2)  ) %>%
melt(id = c('Yield_A2',"Yield_A1")) %>%  mutate(Area = substr(variable,4,8)) %>% head()
out %>%
filter(FF_Area2== 0.05) %>%
select(FF_Area1, Yield_A1) %>%
cbind(.,out %>%
filter(FF_Area1== 0.05) %>%
select(FF_Area2, Yield_A2)  ) %>%
melt(id = c('Yield_A2',"Yield_A1")) %>%  mutate(Area = substr(variable,4,8)) %>% head()
out %>%
mutate(Yield_Total = Yield_A1+Yield_A2) %>%
select(FF_Area1,FF_Area2, Yield_Total) %>%
reshape2::melt(id = c("FF_Area1","FF_Area2")) %>%
mutate(Area = substr(variable,7,8), yield = value) %>%
select(-variable,-value)
out %>%
select(FF_Area1,FF_Area2,Yield_A1,Yield_A2) %>%
reshape2::melt(id = c("FF_Area1","FF_Area2")) %>%
mutate(Area = substr(variable,7,8), yield = value) %>%
select(-variable,-value) %>% head()
out %>%
filter(FF_Area2== 0.05) %>%
select(FF_Area1,FF_Area2,Yield_A1,Yield_A2) %>%
reshape2::melt(id = c("FF_Area1","FF_Area2")) %>%
mutate(Area = substr(variable,7,8), yield = value) %>%
select(-variable,-value) %>% head()
out %>%
filter(FF_Area2== 0.05) %>%
select(FF_Area1,FF_Area2,Yield_A1,Yield_A2) %>%
reshape2::melt(id = c("FF_Area1","FF_Area2")) %>%
mutate(Area = substr(variable,7,8), yield = value) %>%
select(-variable,-value) %>% head()
out %>%
filter(FF_Area2== 0.05) %>%
select(FF_Area1,FF_Area2,Yield_A1,Yield_A2) %>%
reshape2::melt(id = c("FF_Area1","FF_Area2")) %>%
mutate(Area = substr(variable,7,8), yield = value) %>%
select(-variable,-value) %>%
rbind(.,out %>%
filter(FF_Area1== 0.05) %>%
select(FF_Area1,FF_Area2,Yield_A1,Yield_A2) %>%
reshape2::melt(id = c("FF_Area1","FF_Area2")) %>%
mutate(Area = substr(variable,7,8), yield = value) %>%
select(-variable,-value))
out %>%
filter(FF_Area2== 0.05) %>%
select(FF_Area1,FF_Area2,Yield_A1,Yield_A2) %>%
reshape2::melt(id = c("FF_Area1","FF_Area2")) %>%
mutate(Area = substr(variable,7,8), yield = value) %>%
select(-variable,-value) %>%
rbind(.,out %>%
filter(FF_Area1== 0.05) %>%
select(FF_Area1,FF_Area2,Yield_A1,Yield_A2) %>%
reshape2::melt(id = c("FF_Area1","FF_Area2")) %>%
mutate(Area = substr(variable,7,8), yield = value) %>%
select(-variable,-value))  %>%
melt(id = c('Area',"yield"))%>%
ggplot(., aes(x = value, y = Yield_A1, color = Area)) +
geom_line(lwd = 1.1) +
# geom_line(lwd = 1.1, aes(x = FF_Area2, y = Yield_A2)) +
ggsidekick::theme_sleek() +
scale_x_continuous(expand = c(0,0)) + scale_y_continuous(expand = c(0,0)) +
scale_fill_viridis_c(option = 'magma') +
labs(x = 'F',
y = 'Yield')
out %>%
filter(FF_Area2== 0.05) %>%
select(FF_Area1,FF_Area2,Yield_A1,Yield_A2) %>%
reshape2::melt(id = c("FF_Area1","FF_Area2")) %>%
mutate(Area = substr(variable,7,8), yield = value) %>%
select(-variable,-value) %>%
rbind(.,out %>%
filter(FF_Area1== 0.05) %>%
select(FF_Area1,FF_Area2,Yield_A1,Yield_A2) %>%
reshape2::melt(id = c("FF_Area1","FF_Area2")) %>%
mutate(Area = substr(variable,7,8), yield = value) %>%
select(-variable,-value))  %>%
melt(id = c('Area',"yield"))%>%head()
out %>%
filter(FF_Area2== 0.05) %>%
select(FF_Area1,FF_Area2,Yield_A1,Yield_A2) %>%
reshape2::melt(id = c("FF_Area1","FF_Area2")) %>%
mutate(Area = substr(variable,7,8), yield = value) %>%
select(-variable,-value) %>%
rbind(.,out %>%
filter(FF_Area1== 0.05) %>%
select(FF_Area1,FF_Area2,Yield_A1,Yield_A2) %>%
reshape2::melt(id = c("FF_Area1","FF_Area2")) %>%
mutate(Area = substr(variable,7,8), yield = value) %>%
select(-variable,-value))  %>%
melt(id = c('Area',"yield"))%>%
ggplot(., aes(x = value, y = yield, color = Area)) +
geom_line(lwd = 1.1) +
# geom_line(lwd = 1.1, aes(x = FF_Area2, y = Yield_A2)) +
ggsidekick::theme_sleek() +
scale_x_continuous(expand = c(0,0)) + scale_y_continuous(expand = c(0,0)) +
scale_fill_viridis_c(option = 'magma') +
labs(x = 'F',
y = 'Yield')
iso1 <- out %>%
filter(FF_Area2== 0.05) %>%
select(FF_Area1,FF_Area2,Yield_A1,Yield_A2) %>%
reshape2::melt(id = c("FF_Area1","FF_Area2")) %>%
mutate(Area = substr(variable,7,8), yield = value) %>%
select(-variable,-value) %>%
iso2 <- out %>%
filter(FF_Area1== 0.05) %>%
select(FF_Area1,FF_Area2,Yield_A1,Yield_A2) %>%
reshape2::melt(id = c("FF_Area1","FF_Area2")) %>%
mutate(Area = substr(variable,7,8), yield = value) %>%
select(-variable,-value))
melt(id = c('Area',"yield"))%>%
ggplot(., aes(x = value, y = yield, color = Area)) +
geom_line(lwd = 1.1) +
# geom_line(lwd = 1.1, aes(x = FF_Area2, y = Yield_A2)) +
ggsidekick::theme_sleek() +
scale_x_continuous(expand = c(0,0)) + scale_y_continuous(expand = c(0,0)) +
scale_fill_viridis_c(option = 'magma') +
labs(x = 'F',
y = 'Yield')
iso1 <- out %>%
filter(FF_Area2== 0.05) %>%
select(FF_Area1,FF_Area2,Yield_A1,Yield_A2) %>%
reshape2::melt(id = c("FF_Area1","FF_Area2")) %>%
mutate(Area = substr(variable,7,8), yield = value) %>%
select(-variable,-value) %>%
iso2 <- out %>%
filter(FF_Area1== 0.05) %>%
select(FF_Area1,FF_Area2,Yield_A1,Yield_A2) %>%
reshape2::melt(id = c("FF_Area1","FF_Area2")) %>%
mutate(Area = substr(variable,7,8), yield = value) %>%
select(-variable,-value))
iso1 <- out %>%
filter(FF_Area2== 0.05) %>%
select(FF_Area1,FF_Area2,Yield_A1,Yield_A2) %>%
reshape2::melt(id = c("FF_Area1","FF_Area2")) %>%
mutate(Area = substr(variable,7,8), yield = value) %>%
select(-variable,-value) %>%
iso2 <- out %>%
filter(FF_Area1== 0.05) %>%
select(FF_Area1,FF_Area2,Yield_A1,Yield_A2) %>%
reshape2::melt(id = c("FF_Area1","FF_Area2")) %>%
mutate(Area = substr(variable,7,8), yield = value) %>%
select(-variable,-value))
iso1 <- out %>%
filter(FF_Area2== 0.05) %>%
select(FF_Area1,FF_Area2,Yield_A1,Yield_A2) %>%
reshape2::melt(id = c("FF_Area1","FF_Area2")) %>%
mutate(Area = substr(variable,7,8), yield = value) %>%
select(-variable,-value) %>%
iso2 <- out %>%
filter(FF_Area1== 0.05) %>%
select(FF_Area1,FF_Area2,Yield_A1,Yield_A2) %>%
reshape2::melt(id = c("FF_Area1","FF_Area2")) %>%
mutate(Area = substr(variable,7,8), yield = value) %>%
select(-variable,-value)
ggplot(., aes(x = value, y = yield, color = Area)) +
geom_line(lwd = 1.1) +
# geom_line(lwd = 1.1, aes(x = FF_Area2, y = Yield_A2)) +
ggsidekick::theme_sleek() +
scale_x_continuous(expand = c(0,0)) + scale_y_continuous(expand = c(0,0)) +
scale_fill_viridis_c(option = 'magma') +
labs(x = 'F',
y = 'Yield')
iso1 <- out %>%
filter(FF_Area2== 0.05) %>%
select(FF_Area1,FF_Area2,Yield_A1,Yield_A2) %>%
reshape2::melt(id = c("FF_Area1","FF_Area2")) %>%
mutate(Area = substr(variable,7,8), yield = value) %>%
select(-variable,-value) %>%
iso2 <- out %>%
filter(FF_Area1== 0.05) %>%
select(FF_Area1,FF_Area2,Yield_A1,Yield_A2) %>%
reshape2::melt(id = c("FF_Area1","FF_Area2")) %>%
mutate(Area = substr(variable,7,8), yield = value) %>%
select(-variable,-value)
out %>%
filter(FF_Area1== 0.05) %>%
select(FF_Area1,FF_Area2,Yield_A1,Yield_A2) %>%
reshape2::melt(id = c("FF_Area1","FF_Area2")) %>%
mutate(Area = substr(variable,7,8), yield = value) %>%
select(-variable,-value)
iso1 <- out %>%
filter(FF_Area2== 0.05) %>%
select(FF_Area1,FF_Area2,Yield_A1,Yield_A2) %>%
reshape2::melt(id = c("FF_Area1","FF_Area2")) %>%
mutate(Area = substr(variable,7,8), yield = value) %>%
select(-variable,-value) %>%
iso2 <- out %>%
filter(FF_Area1== 0.05) %>%
select(FF_Area1,FF_Area2,Yield_A1,Yield_A2) %>%
reshape2::melt(id = c("FF_Area1","FF_Area2")) %>%
mutate(Area = substr(variable,7,8), yield = value) %>%
select(-variable,-value)
iso1 <- out %>%
filter(FF_Area2== 0.05) %>%
select(FF_Area1,FF_Area2,Yield_A1,Yield_A2) %>%
reshape2::melt(id = c("FF_Area1","FF_Area2")) %>%
mutate(Area = substr(variable,7,8), yield = value) %>%
select(-variable,-value)
iso2 <- out %>%
filter(FF_Area1== 0.05) %>%
select(FF_Area1,FF_Area2,Yield_A1,Yield_A2) %>%
reshape2::melt(id = c("FF_Area1","FF_Area2")) %>%
mutate(Area = substr(variable,7,8), yield = value) %>%
select(-variable,-value)
iso1
plot(iso1$FF_Area1~iso1$yield)
plot(iso1$FF_Area1,iso1$yield)
iso1 <- out %>%
filter(FF_Area2== 0.05) %>%
select(FF_Area1,Yield_A1) %>%
reshape2::melt(id = c("FF_Area1")) %>%
mutate(Area = substr(variable,7,8), yield = value) %>%
select(-variable,-value)
iso1
iso1 <- out %>%
filter(FF_Area2== 0.05) %>%
select(FF_Area1,Yield_A1) %>%
reshape2::melt(id = c("FF_Area1")) %>%
mutate(Area = substr(variable,7,8), yield = value) %>%
select(-variable,-value)
iso2 <- out %>%
filter(FF_Area1== 0.05) %>%
select(FF_Area2,Yield_A2) %>%
reshape2::melt(id = c("FF_Area2")) %>%
mutate(Area = substr(variable,7,8), yield = value) %>%
select(-variable,-value)
ggplot(iso1, aes(x = FF_Area1, y = yield, color = Area)) +
geom_line(lwd = 1.1) +
# geom_line(lwd = 1.1, aes(x = FF_Area2, y = Yield_A2)) +
ggsidekick::theme_sleek() +
scale_x_continuous(expand = c(0,0)) + scale_y_continuous(expand = c(0,0)) +
scale_fill_viridis_c(option = 'magma') +
labs(x = 'F',
y = 'Yield')
ggplot(iso1, aes(x = FF_Area1, y = yield, color = Area)) +
geom_line(lwd = 1.1) +
geom_line(data = iso2, aes(x = FF_Area2)) +
ggsidekick::theme_sleek() +
scale_x_continuous(expand = c(0,0)) + scale_y_continuous(expand = c(0,0)) +
scale_fill_viridis_c(option = 'magma') +
labs(x = 'F',
y = 'Yield')
ggplot(iso1, aes(x = FF_Area1, y = yield, color = Area)) +
geom_line(lwd = 1.1) +
geom_line(data = iso2, aes(x = FF_Area2), lwd = 1.1) +
ggsidekick::theme_sleek() +
scale_x_continuous(expand = c(0,0)) + scale_y_continuous(expand = c(0,0)) +
scale_fill_viridis_c(option = 'magma') +
labs(x = 'F',
y = 'Yield')
ggplot(iso1, aes(x = FF_Area1, y = yield, color = Area)) +
geom_line(lwd = 1.1) +
geom_line(data = iso2, aes(x = FF_Area2), lwd = 1.1) +
ggsidekick::theme_sleek() +
scale_x_continuous(expand = c(0,0)) + scale_y_continuous(expand = c(0,0)) +
scale_color_manual(values = c('grey44','blue')) +
labs(x = 'F',
y = 'Yield')
ggplot(iso1, aes(x = FF_Area1, y = yield, color = Area)) +
geom_line(lwd = 1.1) +
geom_line(data = iso2, aes(x = FF_Area2), lwd = 1.1) +
ggsidekick::theme_sleek() +
scale_x_continuous(expand = c(0,0)) + scale_y_continuous(expand = c(0,0)) +
scale_color_manual(values = c('grey44','blue'), labs = c('Area 1','Area 2')) +
labs(x = 'F',
y = 'Yield', color = 'Area')
ggplot(iso1, aes(x = FF_Area1, y = yield, color = Area)) +
geom_line(lwd = 1.1) +
geom_line(data = iso2, aes(x = FF_Area2), lwd = 1.1) +
ggsidekick::theme_sleek() +
scale_x_continuous(expand = c(0,0)) + scale_y_continuous(expand = c(0,0)) +
scale_color_manual(values = c('grey44','blue'), labels = c('Area 1','Area 2')) +
labs(x = 'F',
y = 'Yield', color = 'Area')
ggplot(iso1, aes(x = FF_Area1, y = yield, color = Area)) +
geom_line(lwd = 1.1) +
geom_line(data = iso2, aes(x = FF_Area2), lwd = 1.1) +
ggsidekick::theme_sleek() +
scale_x_continuous(expand = c(0,0)) + scale_y_continuous(expand = c(0,0)) +
scale_color_manual(values = c('grey44','blue'), labels = c('Area 1','Area 2')) +
labs(x = 'F',
y = 'Yield', color = '')
ggplot(iso1, aes(x = FF_Area1, y = yield, color = Area)) +
geom_line(lwd = 1.1) +
geom_line(data = iso2, aes(x = FF_Area2), lwd = 1.1) +
ggsidekick::theme_sleek() +
scale_x_continuous(expand = c(0,0)) + scale_y_continuous(expand = c(0,0)) +
scale_color_manual(values = c('grey44','blue'), labels = c('Area 1','Area 2')) +
labs(x = 'F', title = 'Yield Isoclines by Area',
subtitle = 'Alternative Area F = 0.05',
y = 'Yield', color = '')
iso1 <- out %>%
filter(FF_Area2== 0.5) %>%
select(FF_Area1,Yield_A1) %>%
reshape2::melt(id = c("FF_Area1")) %>%
mutate(Area = substr(variable,7,8), yield = value) %>%
select(-variable,-value)
iso2 <- out %>%
filter(FF_Area1== 0.5) %>%
select(FF_Area2,Yield_A2) %>%
reshape2::melt(id = c("FF_Area2")) %>%
mutate(Area = substr(variable,7,8), yield = value) %>%
select(-variable,-value)
ggplot(iso1, aes(x = FF_Area1, y = yield, color = Area)) +
geom_line(lwd = 1.1) +
geom_line(data = iso2, aes(x = FF_Area2), lwd = 1.1) +
ggsidekick::theme_sleek() +
scale_x_continuous(expand = c(0,0)) + scale_y_continuous(expand = c(0,0)) +
scale_color_manual(values = c('grey44','blue'), labels = c('Area 1','Area 2')) +
labs(x = 'F', title = 'Yield Isoclines by Area',
subtitle = 'Alternative Area F = 0.05',
y = 'Yield', color = '')
FFs <- expand.grid(seq(0,1.5,0.05),seq(0,1,0.05))
out <- data.frame()
for(i in 1:nrow(FFs)){
out[i,'FF_Area1'] <- FFs[i,1];   out[i,'FF_Area2'] <- FFs[i,2]
tmp <- doPR(dat,FF = as.numeric(c(FFs[i,])))
tmp0 <-  doPR(dat,FF = c(0,0) )
## optimize this
opt_temp <- optim(par = c(4,0.6),
SBPR_F = tmp$SBPR,
SBPR_0 = tmp0$SBPR,
lower = c(1E-4,1E-4),
upper = c(NA,1),
method = "L-BFGS-B",
fn = optimFunc, hessian = FALSE,
control = list(
maxit = 1000,
ndeps = rep(1e-4,2)))
out[i,'estRbar'] <- opt_temp$par[1];  out[i,'estRprop'] <- opt_temp$par[2];
## derived quants at optimized value
yields <- getYield(passR = out[i,'estRbar'], passRprop =   out[i,'estRprop'], YPR_F = tmp$YPR)
out[i,'Yield_A1'] <- yields[1];  out[i,'Yield_A2'] <- yields[2]; ## build this
sbs <- getSB(passR = out[i,'estRbar'], passRprop = out[i,'estRprop'], SBPR_F = tmp$SBPR)
out[i,'SB_A1'] <- sbs[1];  out[i,'SB_A2'] <- sbs[2];
sb0 <- getSB(passR = out[i,'estRbar'], passRprop = out[i,'estRprop'], SBPR_F = tmp0$SBPR)
out[i,'SB0_A1'] <- sb0[1];  out[i,'SB0_A2'] <- sb0[2];
rexp <- getExpR(passR = out[i,'estRbar'], passRprop =   out[i,'estRprop'],SB_F = sbs, SB_0 =sb0)
out[i,'expR_A1'] <- rexp[1];  out[i,'expR_A2'] <- rexp[2];
obsr <- out[i,'estRbar']*c(out[i,'estRprop'],1-out[i,'estRprop'])
out[i,'obsR_A1'] <- obsr[1];  out[i,'obsR_A2'] <- obsr[2];
rm(tmp)
}
source(here('R','figs.R'))
FFs <- expand.grid(seq(0,1,0.05),seq(0,1,0.05))
out <- data.frame()
for(i in 1:nrow(FFs)){
out[i,'FF_Area1'] <- FFs[i,1];   out[i,'FF_Area2'] <- FFs[i,2]
tmp <- doPR(dat,FF = as.numeric(c(FFs[i,])))
tmp0 <-  doPR(dat,FF = c(0,0) )
## optimize this
opt_temp <- optim(par = c(4,0.6),
SBPR_F = tmp$SBPR,
SBPR_0 = tmp0$SBPR,
lower = c(1E-4,1E-4),
upper = c(NA,1),
method = "L-BFGS-B",
fn = optimFunc, hessian = FALSE,
control = list(
maxit = 1000,
ndeps = rep(1e-4,2)))
out[i,'estRbar'] <- opt_temp$par[1];  out[i,'estRprop'] <- opt_temp$par[2];
## derived quants at optimized value
yields <- getYield(passR = out[i,'estRbar'], passRprop =   out[i,'estRprop'], YPR_F = tmp$YPR)
out[i,'Yield_A1'] <- yields[1];  out[i,'Yield_A2'] <- yields[2]; ## build this
sbs <- getSB(passR = out[i,'estRbar'], passRprop = out[i,'estRprop'], SBPR_F = tmp$SBPR)
out[i,'SB_A1'] <- sbs[1];  out[i,'SB_A2'] <- sbs[2];
sb0 <- getSB(passR = out[i,'estRbar'], passRprop = out[i,'estRprop'], SBPR_F = tmp0$SBPR)
out[i,'SB0_A1'] <- sb0[1];  out[i,'SB0_A2'] <- sb0[2];
rexp <- getExpR(passR = out[i,'estRbar'], passRprop =   out[i,'estRprop'],SB_F = sbs, SB_0 =sb0)
out[i,'expR_A1'] <- rexp[1];  out[i,'expR_A2'] <- rexp[2];
obsr <- out[i,'estRbar']*c(out[i,'estRprop'],1-out[i,'estRprop'])
out[i,'obsR_A1'] <- obsr[1];  out[i,'obsR_A2'] <- obsr[2];
rm(tmp)
}
source(here('R','figs.R'))
